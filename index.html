<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>直播計算器</title>
  <style>
    body {
      background-color: #121212;
      color: #ffffff;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input, button, select {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      border-radius: 5px;
      border: none;
      font-size: 16px;
    }
    button {
      background-color: #2196F3;
      color: white;
      cursor: pointer;
    }
    .record {
      border-top: 1px solid #444;
      margin-top: 20px;
      padding-top: 10px;
    }
  </style>
</head>
<body>
  <h1>直播計算器</h1>

  <label>成本（台幣）</label>
  <input id="costTWD" type="number" />

  <label>毛利率（%）</label>
  <input id="marginRate" type="number" />

  <label>售價（台幣）</label>
  <input id="priceTWD" type="number" />

  <label>售價（新幣）</label>
  <input id="priceSGD" type="number" />

  <label>售價（馬幣）</label>
  <input id="priceMYR" type="number" />

  <label>新幣換台幣匯率</label>
  <input id="rateSGD" type="number" value="24" />

  <label>馬幣換台幣匯率</label>
  <input id="rateMYR" type="number" value="6.5" />

  <button onclick="calculate()">計算</button>
  <button onclick="clearInputs()">清空</button>
  <button onclick="clearRecords()">清除計算記錄</button>

  <div class="record" id="records"></div>

  <script>
    const costInput = document.getElementById("costTWD");
    const marginInput = document.getElementById("marginRate");
    const priceTWDInput = document.getElementById("priceTWD");
    const priceSGDInput = document.getElementById("priceSGD");
    const priceMYRInput = document.getElementById("priceMYR");
    const rateSGDInput = document.getElementById("rateSGD");
    const rateMYRInput = document.getElementById("rateMYR");
    const records = document.getElementById("records");

    function calculate() {
      const cost = parseFloat(costInput.value);
      const margin = parseFloat(marginInput.value);
      const priceTWD = parseFloat(priceTWDInput.value);
      const priceSGD = parseFloat(priceSGDInput.value);
      const priceMYR = parseFloat(priceMYRInput.value);
      const rateSGD = parseFloat(rateSGDInput.value);
      const rateMYR = parseFloat(rateMYRInput.value);

      let calculatedTWD = priceTWD;

      if (!priceTWD && priceSGD && rateSGD) {
        calculatedTWD = priceSGD * rateSGD;
        priceTWDInput.value = calculatedTWD.toFixed(2);
      }

      if (!priceTWD && priceMYR && rateMYR) {
        calculatedTWD = priceMYR * rateMYR;
        priceTWDInput.value = calculatedTWD.toFixed(2);
      }

      if (!priceSGD && calculatedTWD && rateSGD) {
        priceSGDInput.value = (calculatedTWD / rateSGD).toFixed(2);
      }
      if (!priceMYR && calculatedTWD && rateMYR) {
        priceMYRInput.value = (calculatedTWD / rateMYR).toFixed(2);
      }

      // 若有成本與售價台幣可計算毛利率
      if (cost && calculatedTWD) {
        const calculatedMargin = ((calculatedTWD - cost) / calculatedTWD) * 100;
        marginInput.value = calculatedMargin.toFixed(2);
      }

      // 若有成本與毛利率可計算售價
      if (cost && margin && !priceTWD) {
        const calculatedPrice = cost / (1 - margin / 100);
        priceTWDInput.value = calculatedPrice.toFixed(2);
        priceSGDInput.value = (calculatedPrice / rateSGD).toFixed(2);
        priceMYRInput.value = (calculatedPrice / rateMYR).toFixed(2);
      }

      addRecord();
    }

    function clearInputs() {
      costInput.value = "";
      marginInput.value = "";
      priceTWDInput.value = "";
      priceSGDInput.value = "";
      priceMYRInput.value = "";
    }

    function clearRecords() {
      records.innerHTML = "";
    }

    function addRecord() {
      const item = document.createElement("div");
      item.innerText = `成本: TWD ${costInput.value}, 毛利率: ${marginInput.value}%, 
      售價: TWD ${priceTWDInput.value}, SGD ${priceSGDInput.value}, MYR ${priceMYRInput.value}`;
      records.prepend(item);
    }
  </script>
</body>
</html>
